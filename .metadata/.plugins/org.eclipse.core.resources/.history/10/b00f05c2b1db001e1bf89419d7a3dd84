package profitcalculationsubscriber;

import java.util.Scanner;

import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;
import org.osgi.framework.ServiceReference;

import profitcalculationpublisher.ProfitCalculationServicePublish;

public class ProfitCalculationActivator implements BundleActivator {

	//object declarations
	private Scanner scanner;
	ServiceReference profitServiceReference;
	//declare ProfitCalculationServicePublish object
	private ProfitCalculationServicePublish profitCalculationServicePublish;
	
	public void start(BundleContext context) throws Exception {
		
		//Initializer Scanner for user input
		this.scanner =  new Scanner(System.in);
		
		System.out.println("Started profit calculation Subscriber Service ");
		
		//get the reference service/publisher
		profitServiceReference = context.getServiceReference(ProfitCalculationServicePublish.class.getName());
		profitCalculationServicePublish = (ProfitCalculationServicePublish)context.getService(profitServiceReference);

		
		if(profitCalculationServicePublish == null) {
            System.out.println(" Profit calculation service available.");
		}else{
			//call the method to get user inputs for calculate profit.
			inputProfitdetails();
		}
	}

	
	public void stop(BundleContext context) throws Exception {
		System.out.println("Stoped Profit calculation Subscriber Service ");
	}
	
	public void inputProfitdetails() {
		
		System.out.println("Enter Event Name :");
		String eventName = scanner.nextLine();
		
		System.out.println("Enter Cost");
		double cost = scanner.nextDouble();
		
		
		System.out.println(eventName);
		// Call addEvent method to add the event
		profitCalculationServicePublish.add(eventName, cost);
		}
	

}
